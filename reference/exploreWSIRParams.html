<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>exploreWSIRParams function — exploreWSIRParams • wSIR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="exploreWSIRParams function — exploreWSIRParams"><meta name="description" content="This function is used to select the optimal values for parameters slices and alpha in weighted sliced inverse regression
based on your provided gene expression data and corresponding spatial coordinates. For a given evaluation metric,
it will visualise the performance of WSIR with varying function parameters based on your data, and return the optimal pair.
This pair of slices and alpha can be used for your downstream tasks."><meta property="og:description" content="This function is used to select the optimal values for parameters slices and alpha in weighted sliced inverse regression
based on your provided gene expression data and corresponding spatial coordinates. For a given evaluation metric,
it will visualise the performance of WSIR with varying function parameters based on your data, and return the optimal pair.
This pair of slices and alpha can be used for your downstream tasks."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">wSIR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/wSIR_vignette.html">Weighted Sliced Inverse Regression (WSIR)</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sydneybiox/wSIR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>exploreWSIRParams function</h1>
      <small class="dont-index">Source: <a href="https://github.com/sydneybiox/wSIR/blob/main/R/exploreWSIRParams.R" class="external-link"><code>R/exploreWSIRParams.R</code></a></small>
      <div class="d-none name"><code>exploreWSIRParams.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is used to select the optimal values for parameters slices and alpha in weighted sliced inverse regression
based on your provided gene expression data and corresponding spatial coordinates. For a given evaluation metric,
it will visualise the performance of WSIR with varying function parameters based on your data, and return the optimal pair.
This pair of slices and alpha can be used for your downstream tasks.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">exploreWSIRParams</span><span class="op">(</span></span>
<span>  <span class="va">exprs</span>,</span>
<span>  <span class="va">coords</span>,</span>
<span>  samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  alpha_vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>  slice_vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>  varThreshold <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  maxDirections <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"DC"</span>,</span>
<span>  nrep <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-exprs">exprs<a class="anchor" aria-label="anchor" href="#arg-exprs"></a></dt>
<dd><p>matrix containing normalised gene expression data including n cells and p genes, dimension n * p.</p></dd>


<dt id="arg-coords">coords<a class="anchor" aria-label="anchor" href="#arg-coords"></a></dt>
<dd><p>dataframe containing spatial positions of n cells in 2D space. Dimension n * 2. Column names must be c("x", "y").</p></dd>


<dt id="arg-samples">samples<a class="anchor" aria-label="anchor" href="#arg-samples"></a></dt>
<dd><p>sample ID of each cell. In total, must have length equal to the number of cells. For example, if
your dataset has 10000 cells, the first 5000 from sample 1 and the remaining 5000 from sample 2, you would write
samples = c(rep(1, 5000), rep(2, 5000)) to specify that the first 5000 cells are sample 1 and the remaining are sample 2.
Default is that all cells are from sample 1. Sample IDs can be of any format: for the previous example, you could write
samples = c(rep("sample 1", 5000), rep("sample 2", 5000)), and the result would be the same.</p></dd>


<dt id="arg-alpha-vals">alpha_vals<a class="anchor" aria-label="anchor" href="#arg-alpha-vals"></a></dt>
<dd><p>vector of numbers as the values of parameter alpha to use in WSIR. 0 gives Sliced Inverse Regression
(SIR) implementation, and larger values represent stronger spatial correlation. Suggest to use integers for interpretability,
but can use non-integers. Values must be non-negative.</p></dd>


<dt id="arg-slice-vals">slice_vals<a class="anchor" aria-label="anchor" href="#arg-slice-vals"></a></dt>
<dd><p>vector of integers as the values of parameter slices to use in WSIR. Suggest maximum value in the vector to
be no more than around \(\sqrt{n/20}\), as this upper bound ensures an average of at least 10 cells per tile in the training set.</p></dd>


<dt id="arg-varthreshold">varThreshold<a class="anchor" aria-label="anchor" href="#arg-varthreshold"></a></dt>
<dd><p>numeric proportion of variance in <code>t(X_H) %*% W %*% X_H</code> to retain. Must be between 0 and 1. Default is 0.95.
Select higher threshold to include more dimensions, lower threshold to include less dimensions.</p></dd>


<dt id="arg-maxdirections">maxDirections<a class="anchor" aria-label="anchor" href="#arg-maxdirections"></a></dt>
<dd><p>integer for the maximum number of directions to include in the low-dimenensional embedding. Default is 50.</p></dd>


<dt id="arg-metric">metric<a class="anchor" aria-label="anchor" href="#arg-metric"></a></dt>
<dd><p>evaluation metric to use for parameter tuning. String, either "DC" to use distance correlation or "CD" to use
correlation of distances. Default is "DC".</p></dd>


<dt id="arg-nrep">nrep<a class="anchor" aria-label="anchor" href="#arg-nrep"></a></dt>
<dd><p>integer for the number of train/test splits of the data to perform.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List with five slots, named "plot", "message", "best_alpha", "best_slices" and "results_dataframe".</p><ol><li><p>"plot" shows the average metric value across the nrep iterations for every combination of parameters slices and alpha.
Larger circles for a slices/alpha combination indicates better performance for that pair of values.</p></li>
<li><p>"message" tells you the parameter combination with highest metric value.</p></li>
<li><p>"best_alpha" returns the integer for the best alpha values among the values that were tested.</p></li>
<li><p>"best_slices" returns the integer for the best slices value among the values that were tested.</p></li>
<li><p>"results_dataframe" returns the results dataframe used to create "plot". This dataframe has length(alpha_vals)*length(slice_vals) rows,
where one is for each combination of parameters slices and alpha. There are 3 columns, named "alpha", "slices" and "metric". Column
"alpha" includes the value for parameter alpha, column "slices" includes the value for parameter slices, and column
"metric" includes the value for the specified metric, either Distance Correlation ("DC") or Correlation of Distances ("CD").</p></li>
</ol></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">MouseData</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">explore_params</span> <span class="op">=</span> <span class="fu">exploreWSIRParams</span><span class="op">(</span>exprs <span class="op">=</span> <span class="va">sample1_exprs</span>,</span></span>
<span class="r-in"><span>  coords <span class="op">=</span> <span class="va">sample1_coords</span>,</span></span>
<span class="r-in"><span>  alpha_vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">8</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  slice_vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">explore_params</span><span class="op">$</span><span class="va">plot</span></span></span>
<span class="r-plt img"><img src="exploreWSIRParams-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">explore_params</span><span class="op">$</span><span class="va">message</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Optimal (alpha, slices) pair: (8, 3)"</span>
<span class="r-in"><span><span class="va">best_alpha</span> <span class="op">=</span> <span class="va">explore_params</span><span class="op">$</span><span class="va">best_alpha</span></span></span>
<span class="r-in"><span><span class="va">best_slices</span> <span class="op">=</span> <span class="va">explore_params</span><span class="op">$</span><span class="va">best_slices</span></span></span>
<span class="r-in"><span><span class="va">wsir_obj</span> <span class="op">=</span> <span class="fu"><a href="wSIR.html">wSIR</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">sample1_exprs</span>,</span></span>
<span class="r-in"><span>  coords <span class="op">=</span> <span class="va">sample1_coords</span>,</span></span>
<span class="r-in"><span>  optim_params <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  alpha <span class="op">=</span> <span class="va">best_alpha</span>,</span></span>
<span class="r-in"><span>  slices <span class="op">=</span> <span class="va">best_slices</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Max Woollard, Linh Nghiem, Shila Ghazanfar.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

