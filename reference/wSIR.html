<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>wSIR — wSIR • wSIR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="wSIR — wSIR"><meta name="description" content="A function to perform supervised dimension reduction of a gene expression
matrix using coordinates dataframe as
response value. Incorporates weighting mechanism into SIR algorithm to
generate low-dimensional representation of
the data and allow for projection of new single-cell gene expression data
into low-dimensional space."><meta property="og:description" content="A function to perform supervised dimension reduction of a gene expression
matrix using coordinates dataframe as
response value. Incorporates weighting mechanism into SIR algorithm to
generate low-dimensional representation of
the data and allow for projection of new single-cell gene expression data
into low-dimensional space."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">wSIR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/wSIR_vignette.html">Weighted Sliced Inverse Regression (WSIR)</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sydneybiox/wSIR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>wSIR</h1>
      <small class="dont-index">Source: <a href="https://github.com/sydneybiox/wSIR/blob/main/R/wSIR.R" class="external-link"><code>R/wSIR.R</code></a></small>
      <div class="d-none name"><code>wSIR.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A function to perform supervised dimension reduction of a gene expression
matrix using coordinates dataframe as
response value. Incorporates weighting mechanism into SIR algorithm to
generate low-dimensional representation of
the data and allow for projection of new single-cell gene expression data
into low-dimensional space.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">wSIR</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">coords</span>,</span>
<span>  optim_params <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  optim_alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>  optim_slices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"DC"</span>,</span>
<span>  nrep <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>matrix containing normalised gene expression data including n
cells and p genes, dimension n * p.</p></dd>


<dt id="arg-coords">coords<a class="anchor" aria-label="anchor" href="#arg-coords"></a></dt>
<dd><p>dataframe containing spatial positions of n cells in 2D
space. Dimension n * 2. Column names must be c("x", "y").</p></dd>


<dt id="arg-optim-params">optim_params<a class="anchor" aria-label="anchor" href="#arg-optim-params"></a></dt>
<dd><p>logical default FALSE. If you would like wSIR to
automatically optimise parameters slices and alpha based on
either distance correlation or correlation of distances as evaluation
metric. If your downstream
task is quite different to either of those metrics, then we suggest you
tune those two parameters yourself using
your specific task and evaluation metric. In that case, determine your
optimal slices and alpha values and then use
them in the relevant function, then setting optim_params = FALSE.</p></dd>


<dt id="arg-optim-alpha">optim_alpha<a class="anchor" aria-label="anchor" href="#arg-optim-alpha"></a></dt>
<dd><p>If you have optim_params = TRUE, then this is the
values of alpha to optimise over in wSIR. 0
gives Sliced Inverse Regression (SIR) implementation, and larger values
represent stronger spatial correlation.
Suggest to use integers for interpretability, but can use non-integers.
Values must be non-negative.</p></dd>


<dt id="arg-optim-slices">optim_slices<a class="anchor" aria-label="anchor" href="#arg-optim-slices"></a></dt>
<dd><p>If you have optim_params = TRUE, then this is the values
of slices to optimise over in wSIR.
Suggest maximum value in the vector to be no more than around
\(\sqrt{n/20}\), as this upper bound ensures an
average of at least 10 cells per tile in the training set.</p></dd>


<dt id="arg-metric">metric<a class="anchor" aria-label="anchor" href="#arg-metric"></a></dt>
<dd><p>If optim_params = TRUE, this is the evaluation metric to use
for parameter tuning. String,
either "DC" to use distance correlation or "CD" to use correlation of
distances. Default is "DC".</p></dd>


<dt id="arg-nrep">nrep<a class="anchor" aria-label="anchor" href="#arg-nrep"></a></dt>
<dd><p>If optim_params = TRUE, this is the integer for the number of
train/test splits of the data to
perform during optimisation of parameters slices and alpha.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical (default FALSE) whether progress messages should be
printed</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>arguments passing to <code>exploreWSIRParams</code> and <code>wSIRSpecifiedParams</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>wSIR object which is a list containing 5 (named) positions.</p><ol><li><p>scores matrix containing low-dimensional
representation of X from wSIR algorithm. Dimension <code>n * d</code>, where d is
chosen to include at least varThreshold proportion of variance.</p></li>
<li><p>directions matrix containing wSIR directions, dimension <code>p * d</code>. Use
this to project new data into low-dimensional space via X_new %*% directions.</p></li>
<li><p>estd integer stating how many dimensions in the computed
low-dimensional space are needed to account for varThreshold
proportion of variance. Same as number of dimensions in scores.</p></li>
<li><p>W matrix weight matrix from cells_weight_matrix2 function</p></li>
<li><p>evalues vector containing p eigenvalues of <code>t(X_H) %*% W %*% X_H</code>.
varThreshold parameter works on these evalues,
such that e.g the first j directions are included if the sum of the
first j evalues equals 0.95% of the sum of all evalues.</p></li>
</ol></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">MouseData</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">wsir_obj</span> <span class="op">=</span> <span class="fu">wSIR</span><span class="op">(</span>X <span class="op">=</span> <span class="va">sample1_exprs</span>,</span></span>
<span class="r-in"><span>  coords <span class="op">=</span> <span class="va">sample1_coords</span>,</span></span>
<span class="r-in"><span>  optim_params <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  optim_alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  optim_slices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  metric <span class="op">=</span> <span class="st">"DC"</span>,</span></span>
<span class="r-in"><span>  nrep <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># create wsir object</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> set up nrep random splits of the data into training and test sets</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> completed runs of wSIR and metric calculation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Optimal (alpha, slices) pair: (0, 3)</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Max Woollard, Linh Nghiem, Shila Ghazanfar.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

