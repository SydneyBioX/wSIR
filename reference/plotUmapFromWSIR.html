<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>plotUmapFromWSIR — plotUmapFromWSIR • wSIR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="plotUmapFromWSIR — plotUmapFromWSIR"><meta name="description" content="A function to plot a UMAP generated on the low-dimensional embedding of the gene expression data. The points are coloured by
their value for the genes with highest (in absolute value) loading in a selected WSIR direction, by default WSIR1."><meta property="og:description" content="A function to plot a UMAP generated on the low-dimensional embedding of the gene expression data. The points are coloured by
their value for the genes with highest (in absolute value) loading in a selected WSIR direction, by default WSIR1."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">wSIR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/wSIR_vignette.html">Weighted Sliced Inverse Regression (WSIR)</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sydneybiox/wSIR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>plotUmapFromWSIR</h1>
      <small class="dont-index">Source: <a href="https://github.com/sydneybiox/wSIR/blob/main/R/plotUmapFromWSIR.R" class="external-link"><code>R/plotUmapFromWSIR.R</code></a></small>
      <div class="d-none name"><code>plotUmapFromWSIR.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A function to plot a UMAP generated on the low-dimensional embedding of the gene expression data. The points are coloured by
their value for the genes with highest (in absolute value) loading in a selected WSIR direction, by default WSIR1.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotUmapFromWSIR</span><span class="op">(</span></span>
<span>  <span class="va">exprs</span>,</span>
<span>  <span class="va">umap_coords</span>,</span>
<span>  highest_genes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  genes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">n_genes</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-exprs">exprs<a class="anchor" aria-label="anchor" href="#arg-exprs"></a></dt>
<dd><p>matrix containing normalised gene expression data including n cells and p genes, dimension n * p.</p></dd>


<dt id="arg-umap-coords">umap_coords<a class="anchor" aria-label="anchor" href="#arg-umap-coords"></a></dt>
<dd><p>UMAP coordinates for each cell that is output of generateUmapFromWSIR function. The UMAP coordinates can be
based on any dimension reduction method, e.g they could be the UMAP coordinates computed on the WSIR dimension reduction
of the gene expression data, or on the PCs (principal components), or on any other low-dimensional matrix. Must be
a matrix of dimension nrow(exprs) * 2.</p></dd>


<dt id="arg-highest-genes">highest_genes<a class="anchor" aria-label="anchor" href="#arg-highest-genes"></a></dt>
<dd><p>output from findTopGenes function. Default is NULL so an error message can easily be thrown if genes
and highest_genes are both not provided.</p></dd>


<dt id="arg-genes">genes<a class="anchor" aria-label="anchor" href="#arg-genes"></a></dt>
<dd><p>vector with gene names (must all be in colnames(exprs)) you wish to show in the UMAP plot. The cells
in those plots will be coloured by their expression values for the genes you provide here. Must provide either genes
or highest_genes parameter (not both): provide genes if you want to visualise a few specific genes, provide highest_genes
if you want to visualise the genes that are found to be the most important to the WSIR directions. Default is NULL
so an error message can easily be thrown if genes and highest_genes are both not provided.</p></dd>


<dt id="arg-n-genes">n_genes<a class="anchor" aria-label="anchor" href="#arg-n-genes"></a></dt>
<dd><p>integer for the number of genes you would like to show. Default is the number of unique genes in the
highest_genes parameter or the number of genes in the (vector) parameter genes. Use this parameter if you want to
show only a few of the most important genes (e.g select the top 4 with n_genes = 4).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional parameters for ggplot functions, e.g size (for size of points).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Grid of umap plots with n_genes number of plots. Each shows the cells in a UMAP generated on the low-dimensional gene
expression data, coloured by their value for each of the genes found by top_genes.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">MouseData</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">wsir_obj</span> <span class="op">=</span> <span class="fu"><a href="wSIR.html">wSIR</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">sample1_exprs</span>,</span></span>
<span class="r-in"><span>  coords <span class="op">=</span> <span class="va">sample1_coords</span>,</span></span>
<span class="r-in"><span>  optim_params <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  alpha <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  slices <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="co"># create wsir object</span></span></span>
<span class="r-in"><span><span class="va">umap_coords</span> <span class="op">=</span> <span class="fu"><a href="generateUmapFromWSIR.html">generateUmapFromWSIR</a></span><span class="op">(</span>WSIR <span class="op">=</span> <span class="va">wsir_obj</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">top_genes_obj</span> <span class="op">=</span> <span class="fu"><a href="findTopGenes.html">findTopGenes</a></span><span class="op">(</span>WSIR <span class="op">=</span> <span class="va">wsir_obj</span>, highest <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="co"># create top genes object</span></span></span>
<span class="r-in"><span><span class="va">umap_plot</span> <span class="op">=</span> <span class="fu">plotUmapFromWSIR</span><span class="op">(</span>umap_coords <span class="op">=</span> <span class="va">umap_coords</span>,</span></span>
<span class="r-in"><span>  exprs <span class="op">=</span> <span class="va">sample1_exprs</span>,</span></span>
<span class="r-in"><span>  highest_genes <span class="op">=</span> <span class="va">top_genes_obj</span>,</span></span>
<span class="r-in"><span>  n_genes <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">umap_plot</span></span></span>
<span class="r-plt img"><img src="plotUmapFromWSIR-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Max Woollard, Linh Nghiem, Shila Ghazanfar.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

